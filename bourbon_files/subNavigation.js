define(["jq!starfield/jquery.mod"],function(a){function d(a){return parseFloat(a)||0}function e(b,c){if(b[0]===window)return 0;var e=b.css(c+"Style")==="none"?0:b.css(c+"Width"),f=a.browser.msie&&a.browser.version=="8.0";switch(e){case"thin":return f?1:2;case"medium":return f?3:4;case"thick":return f?5:6;default:return d(e)}}function h(a){return a.find("> ul")}function i(){a(function(){a(".wsb-nav").parent().css("z-index",1e4)})}var b={scroll:"scrollLeft",pos:"left",margin:"marginLeft",border:"borderLeft",size:"width",outerSize:"outerWidth"},c={scroll:"scrollTop",pos:"top",margin:"marginTop",border:"borderTop",size:"height",outerSize:"outerHeight"},f=!a.browser.webkit&&!/chrome/i.test(navigator.userAgent),g=function(g){function l(a,b){return function(c){var k=b(c)+d(c.css(a.margin));return f&&(k+=e(c.parent(),a.border)),{isVisible:function(){var b=c.offset(),d=b[a.pos]+k-i[a.pos]-e(h,a.border),f=g[a.outerSize]()||0,l=h[a.scroll]()||0;return d>l&&d+f<l+j[a.size]},apply:function(){g.css(a.pos,c.position()[a.pos]+k+"px"),g.css("z-index",1e4)}}}}function m(a){return l(a,function(){return 1-g[a.outerSize]()})}function n(a){return l(a,function(){return 0})}function o(a){return l(a,function(b){return(b[a.outerSize]()-g[a.outerSize]())/2})}function p(a){return l(a,function(b){return b[a.outerSize]()-g[a.outerSize]()})}function q(a){return l(a,function(b){return b[a.outerSize]()-1})}var h,i,j,k=g.parents("#mobileView");return k.length?(h=k,i=k.offset(),j={width:h[0].clientWidth,height:h[0].clientHeight}):(h=a(window),i={top:0,left:0},j={width:h[0].innerWidth||document.documentElement.clientWidth,height:h[0].innerHeight||document.documentElement.clientHeight}),{leftOf:m(b),leftAlignedWith:n(b),centeredWith:o(b),rightAlignedWith:p(b),rightOf:q(b),above:m(c),topAlignedWith:n(c),bottomAlignedWith:p(c),below:q(c)}};return a(document).on("mouseover.subnav",".wsb-nav li",function(){var b=a(this),c=h(b);if(!c.length)return;var d=b.parents(".wsb-nav").css("zIndex",10001);c.css({display:"table",visibility:"visible"});var e=g(c),f=e.leftAlignedWith(b),i=e.centeredWith(b),j=e.rightAlignedWith(b),k={horizontal:{primaryAxisPlacements:[e.below(b),e.above(b)],secondaryAxisPlacements:d.is(".nav-text-left")?[f,i,j]:d.is(".nav-text-right")?[j,i,f]:[i,f,j]},vertical:{primaryAxisPlacements:[e.rightOf(b),e.leftOf(b)],secondaryAxisPlacements:[e.topAlignedWith(b),e.bottomAlignedWith(b)]}},l=d.is(".nav-horizontal")&&b.parents("ul").length===1?[k.horizontal,k.vertical]:[k.vertical,k.horizontal],m=l[0],n=m.primaryAxisPlacements[0];for(var o=0;o<l.length;o++){var p=l[o],q=null;for(var r=0;r<p.primaryAxisPlacements.length;r++)if(p.primaryAxisPlacements[r].isVisible()){q=p.primaryAxisPlacements[r];break}if(q){n=q,m=p;break}}var s=m.secondaryAxisPlacements[0];for(var o=0;o<m.secondaryAxisPlacements.length;o++)if(m.secondaryAxisPlacements[o].isVisible()){s=m.secondaryAxisPlacements[o];break}n.apply(),s.apply()}).on("mouseout.subnav",".wsb-nav li",function(){var b=a(this);b.parents(".wsb-nav").css("zIndex",1e4),h(b).css("visibility","hidden").off("mouseout.subnav")}),{initialize:i}})